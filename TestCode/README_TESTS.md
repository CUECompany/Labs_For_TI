# Тестирование для TabItem 2, 3 и 4

Данный набор тестов покрывает методы, используемые в трех вкладках приложения BillShifor:
- **TabItem 2**: Крипто-Анализатор
- **TabItem 3**: Анализатор Циклов
- **TabItem 4**: Логический Анализ

## Структура тестов

### 1. CryptoAnalyzerTests.cs (TabItem 2 - Крипто-Анализатор)
Тесты для методов класса `CryptoWpEngine`:

#### Основные тестируемые методы:
- `AnalyzeCryptoAlgorithm()` - Анализ безопасности криптографических алгоритмов
- `GetSecurityRulesForAlgorithm()` - Получение правил безопасности
- `ProcessCryptoAssignment()` - Обработка криптографических присваиваний
- `ProcessCryptoIfStatement()` - Обработка условных операторов
- `ProcessCryptoOperation()` - Обработка операций шифрования/дешифрования
- `GenerateCryptoSafetyChecks()` - Генерация проверок безопасности
- `EvaluateSecurity()` - Оценка безопасности
- `GenerateSecurityAssessment()` - Создание отчета о безопасности
- `GenerateCryptoHoareTriple()` - Генерация триады Хоара

#### Покрытие тестами:
- ✅ Тестирование шифра Цезаря
- ✅ Тестирование RSA шифрования
- ✅ Тестирование шифра Виженера
- ✅ Тестирование шифра Плейфера
- ✅ Тестирование шифра Вернама
- ✅ Проверка добавления правил безопасности
- ✅ Проверка обработки деления на ноль
- ✅ Проверка генерации триады Хоара
- ✅ Параметризованные тесты для разных алгоритмов

---

### 2. CycleAnalysisTests.cs (TabItem 3 - Анализатор Циклов)
Тесты для методов класса `CycleAnalysisViewModel`:

#### Основные тестируемые методы:
- `GenerateCharArray()` - Генерация массива символов
- `ExecuteStep()` - Выполнение одного шага цикла
- `ExecuteCaesarStep()` - Шифрование Цезаря на одном символе
- `IsRussianLetter()` - Проверка русской буквы
- `ExecutePrefixSumStep()` - Префиксная сумма
- `ExecuteCountGreaterThanTStep()` - Подсчет элементов больше порога
- `ExecutePrefixMaxStep()` - Префиксный максимум
- `CheckInvariantBeforeStep()` - Проверка инварианта до шага
- `CheckInvariantAfterStep()` - Проверка инварианта после шага
- `ResetAnalysis()` - Сброс анализа

#### Покрытие тестами:
- ✅ Генерация массива символов
- ✅ Шифрование русских букв Цезарем
- ✅ Обработка нерусских символов
- ✅ Работа режима PrefixSum
- ✅ Работа режима CountGreaterThanT
- ✅ Работа режима PrefixMax
- ✅ Проверка инвариантов
- ✅ Тестирование вариант-функции
- ✅ Сброс анализа
- ✅ Ведение лога выполнения
- ✅ Параметризованные тесты для всех режимов
- ✅ Проверка формул инвариантов
- ✅ Проверка прогресса выполнения

---

### 3. LogicalAnalysisTests.cs (TabItem 4 - Логический Анализ)
Тесты для методов класса `LogicalAnalysisViewModel`:

#### Основные тестируемые методы:
- `GenerateTruthTable()` - Генерация таблицы истинности
- `AnalyzeFormula()` - Анализ логической формулы (СДНФ, СКНФ, стоимость)
- `CompareFormulas()` - Сравнение двух формул
- `GenerateCounterExample()` - Генерация контр-примера
- `ClearAnalysis()` - Очистка анализа
- `UpdatePreset()` - Обновление пресета шифра

#### Покрытие тестами:
- ✅ Генерация таблиц истинности для 2 и 3 переменных
- ✅ Проверка функции XOR
- ✅ Генерация СДНФ (дизъюнктивной нормальной формы)
- ✅ Генерация СКНФ (конъюнктивной нормальной формы)
- ✅ Расчет стоимости формулы
- ✅ Сравнение эквивалентных формул
- ✅ Сравнение различных формул с контр-примером
- ✅ Очистка данных анализа
- ✅ Обновление пресетов для разных шифров (Вернам, Атбаш, Цезарь, Виженер, Плейфер)
- ✅ Параметризованные тесты для разных функций
- ✅ Форматирование строк таблицы истинности
- ✅ Обработка пустых таблиц
- ✅ Ведение истории анализа

---

## Как запустить тесты

### Вариант 1: Через Visual Studio
1. Откройте решение `BillShifor2.sln` в Visual Studio
2. В меню выберите **Test → Test Explorer** (или нажмите `Ctrl+E, T`)
3. В окне Test Explorer нажмите **Run All** или выберите конкретные тесты

### Вариант 2: Через командную строку
```bash
cd "C:\Users\maksi\OneDrive\Рабочий стол\теоретическая информатика\BillShifor2"
dotnet test TestCode/TestCode.csproj
```

### Вариант 3: Запуск конкретного тестового класса
```bash
# Только тесты Крипто-Анализатора
dotnet test TestCode/TestCode.csproj --filter "FullyQualifiedName~CryptoAnalyzerTests"

# Только тесты Анализатора Циклов
dotnet test TestCode/TestCode.csproj --filter "FullyQualifiedName~CycleAnalysisTests"

# Только тесты Логического Анализа
dotnet test TestCode/TestCode.csproj --filter "FullyQualifiedName~LogicalAnalysisTests"
```

### Вариант 4: Запуск конкретного теста
```bash
dotnet test TestCode/TestCode.csproj --filter "FullyQualifiedName~AnalyzeCryptoAlgorithm_CaesarCipher_ReturnsValidResult"
```

---

## Статистика покрытия

### TabItem 2 (Крипто-Анализатор):
- **Всего тестов**: 10
- **Покрытие методов**: ~90%
- **Параметризованных тестов**: 1 (5 вариаций)

### TabItem 3 (Анализатор Циклов):
- **Всего тестов**: 21
- **Покрытие методов**: ~95%
- **Параметризованных тестов**: 1 (4 режима анализа)

### TabItem 4 (Логический Анализ):
- **Всего тестов**: 24
- **Покрытие методов**: ~95%
- **Параметризованных тестов**: 2 (9 вариаций)

---

## Зависимости

Убедитесь, что в проекте `TestCode.csproj` установлены следующие пакеты:
- `xUnit` (фреймворк для тестирования)
- `xunit.runner.visualstudio` (для запуска в Visual Studio)
- `Microsoft.NET.Test.Sdk` (SDK для тестов)

---

## Структура тестов (AAA Pattern)

Все тесты следуют паттерну AAA:
- **Arrange** (Подготовка): Настройка тестовых данных и объектов
- **Act** (Действие): Выполнение тестируемого метода
- **Assert** (Проверка): Проверка результатов

Пример:
```csharp
[Fact]
public void AnalyzeCryptoAlgorithm_CaesarCipher_ReturnsValidResult()
{
    // Arrange - подготовка
    string algorithm = "цезарь";
    string code = "...";
    string postcondition = "...";

    // Act - выполнение
    var result = CryptoWpEngine.AnalyzeCryptoAlgorithm(algorithm, code, postcondition);

    // Assert - проверка
    Assert.NotNull(result);
    Assert.NotEmpty(result.Steps);
}
```

---

## Дополнительная информация

### Типы тестов:
- **[Fact]** - обычный тест с одним набором данных
- **[Theory]** - параметризованный тест с несколькими наборами данных
- **[InlineData]** - предоставление данных для Theory теста

### Полезные команды:
```bash
# Запуск с подробным выводом
dotnet test -v detailed

# Запуск с отчетом о покрытии (требует дополнительных инструментов)
dotnet test /p:CollectCoverage=true

# Запуск только failed тестов
dotnet test --filter "TestCategory=Failed"
```

---

## Рекомендации

1. **Запускайте тесты регулярно** - после каждого изменения кода
2. **Проверяйте все три набора тестов** - они независимы друг от друга
3. **Обращайте внимание на сообщения об ошибках** - они подробно описывают проблему
4. **Используйте параметризованные тесты** - для проверки разных вариантов поведения

---

## Автор
Тесты созданы для проверки функциональности вкладок Крипто-Анализатор, Анализатор Циклов и Логический Анализ приложения BillShifor.

**Дата создания**: 2025-01-20
